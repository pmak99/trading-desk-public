# Budget Configuration for API Usage
# Edit these values to control costs

# Perplexity monthly hard limit (USD) - HARD STOP at $4.90
perplexity_monthly_limit: 4.90

# Total monthly budget including fallback models (USD)
monthly_budget: 5.00

# Warn when reaching this percentage of Perplexity budget
warn_at_percentage: 80  # Warn at $3.92

# Stop all API calls when budget exceeded
hard_stop: true

# Model cascade strategy (order of preference)
# When Perplexity limit reached, automatically fall back to next model
model_cascade:
  enabled: true
  order:
    - "perplexity"  # Try Perplexity first (until $4.90 limit)
    - "anthropic"   # Fall back to Claude Sonnet 4.5
    - "google"      # Fall back to Google Gemini

# Model selection and costs
models:
  # Perplexity models
  sonar-pro:
    cost_per_1k_tokens: 0.005  # $5 per 1M tokens
    timeout: 20  # seconds
    use_case: "daily"  # Daily routine analysis

  sonar-deep-research:
    cost_per_1k_tokens: 0.025  # $25 per 1M tokens - ACTUAL: ~$0.75/call!
    timeout: 120  # seconds - very slow, often times out
    use_case: "manual_only"  # AVOID - too expensive, use only on explicit user request
    warning: "VERY EXPENSIVE - $0.75+ per call, even timeouts are charged!"

  # GPT models via Perplexity API (uses same PERPLEXITY_API_KEY)
  gpt-4o:
    cost_per_1k_tokens: 0.001  # $1 per 1M tokens via Perplexity
    timeout: 30  # seconds
    use_case: "daily"  # Good for strategy generation

  gpt-4o-mini:
    cost_per_1k_tokens: 0.0002  # $0.20 per 1M tokens via Perplexity
    timeout: 30  # seconds
    use_case: "daily"  # Cheaper alternative

  # Claude models (fallback when Perplexity exhausted)
  claude-sonnet-4.5:
    provider: "anthropic"
    cost_per_1k_tokens: 0.003  # $3 per 1M input tokens
    cost_per_1k_output_tokens: 0.015  # $15 per 1M output tokens
    timeout: 30
    use_case: "fallback"
    api_key_env: "ANTHROPIC_API_KEY"

  # Google Gemini models (secondary fallback)
  gemini-2.0-flash:
    provider: "google"
    cost_per_1k_tokens: 0.0  # Free tier: 1500 RPD
    timeout: 30
    use_case: "fallback"
    api_key_env: "GOOGLE_API_KEY"
    free_tier_limit: 1500  # Requests per day

# Daily limits
daily_limits:
  max_tickers: 5  # Maximum tickers to analyze per day
  max_api_calls: 20  # Total API calls per day

  # Per-model daily limits
  sonar-pro_calls: 20  # Primary model for daily analysis (cheap!)
  sonar-deep-research_calls: 0  # DISABLED - too expensive, use manual_trigger only
  gpt-4o_calls: 10  # Strategy generation
  gpt-4o-mini_calls: 20  # Cheaper alternative for strategy generation

# Default model preferences
defaults:
  sentiment_model: "sonar-pro"  # Fast, cheap ($0.005/1k tokens)
  strategy_model: "sonar-pro"  # Same model for strategies ($0.005/1k tokens)

  # When to use deep research (DISABLED by default - too expensive!)
  # Only use when user explicitly requests it for critical decisions
  use_deep_research_when:
    manual_trigger_only: true  # Only on explicit user request
    cost_warning: "⚠️ Deep research costs ~$0.75 per call - confirm before using!"

# Alpha Vantage (free tier)
alpha_vantage:
  calls_per_day: 25  # Free tier limit
  cost_per_call: 0.00  # Free

# Logging
logging:
  enabled: true
  log_file: "data/usage.json"
  log_level: "INFO"
